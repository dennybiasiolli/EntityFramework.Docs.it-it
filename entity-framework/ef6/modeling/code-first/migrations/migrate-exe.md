---
title: Uso di migrate. exe-EF6
author: divega
ms.date: 10/23/2016
ms.assetid: 989ea862-e936-4c85-926a-8cfbef5df5b8
ms.openlocfilehash: 34866ddbbf81f090a064af148a612dd354ae9401
ms.sourcegitcommit: 7a709ce4f77134782393aa802df5ab2718714479
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/04/2019
ms.locfileid: "74824819"
---
# <a name="using-migrateexe"></a><span data-ttu-id="3ec3f-102">Uso di migrate. exe</span><span class="sxs-lookup"><span data-stu-id="3ec3f-102">Using migrate.exe</span></span>
<span data-ttu-id="3ec3f-103">Migrazioni Code First può essere utilizzato per aggiornare un database all'interno di Visual Studio, ma può essere eseguito anche tramite lo strumento da riga di comando migrate. exe.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-103">Code First Migrations can be used to update a database from inside visual studio, but can also be executed via the command line tool migrate.exe.</span></span> <span data-ttu-id="3ec3f-104">Questa pagina fornirà una rapida panoramica sull'utilizzo di migrate. exe per eseguire le migrazioni in un database.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-104">This page will give a quick overview on how to use migrate.exe to execute migrations against a database.</span></span>

> [!NOTE]
> <span data-ttu-id="3ec3f-105">Questo articolo presuppone che l'utente sappia come usare Migrazioni Code First negli scenari di base.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-105">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="3ec3f-106">In caso contrario, sarà necessario leggere [migrazioni Code First](~/ef6/modeling/code-first/migrations/index.md) prima di continuare.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-106">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="copy-migrateexe"></a><span data-ttu-id="3ec3f-107">Copia migrate. exe</span><span class="sxs-lookup"><span data-stu-id="3ec3f-107">Copy migrate.exe</span></span>

<span data-ttu-id="3ec3f-108">Quando si installa Entity Framework usando NuGet migrate. exe si troverà all'interno della cartella Tools del pacchetto scaricato.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-108">When you install Entity Framework using NuGet migrate.exe will be inside the tools folder of the downloaded package.</span></span> <span data-ttu-id="3ec3f-109">In &lt;cartella di progetto&gt;pacchetti di \\\\EntityFramework.&lt;versione&gt;\\Tools</span><span class="sxs-lookup"><span data-stu-id="3ec3f-109">In &lt;project folder&gt;\\packages\\EntityFramework.&lt;version&gt;\\tools</span></span>

<span data-ttu-id="3ec3f-110">Dopo aver eseguito migrate. exe, è necessario copiarlo nel percorso dell'assembly che contiene le migrazioni.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-110">Once you have migrate.exe then you need to copy it to the location of the assembly that contains your migrations.</span></span>

<span data-ttu-id="3ec3f-111">Se l'applicazione è destinata a .NET 4 e non a 4,5, sarà necessario copiare anche il **file Redirect. config** nel percorso e rinominare il file **migrate. exe. config**. In questo modo, migrate. exe ottiene i reindirizzamenti di binding corretti per poter individuare l'assembly Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-111">If your application targets .NET 4, and not 4.5, then you will need to copy the **Redirect.config** into the location as well and rename it **migrate.exe.config**. This is so that migrate.exe gets the correct binding redirects to be able to locate the Entity Framework assembly.</span></span>

| <span data-ttu-id="3ec3f-112">.NET 4.5</span><span class="sxs-lookup"><span data-stu-id="3ec3f-112">.NET 4.5</span></span>                                      | <span data-ttu-id="3ec3f-113">.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="3ec3f-113">.NET 4.0</span></span>                                      |
|:----------------------------------------------|:----------------------------------------------|
| ![File .NET 4,5](~/ef6/media/net45files.png) | ![File .NET 4,0](~/ef6/media/net40files.png) |

> [!NOTE]
> <span data-ttu-id="3ec3f-116">migrate. exe non supporta gli assembly x64.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-116">migrate.exe doesn't support x64 assemblies.</span></span>

<span data-ttu-id="3ec3f-117">Dopo aver spostato migrate. exe nella cartella corretta, sarà possibile utilizzarlo per eseguire le migrazioni sul database.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-117">Once you have moved migrate.exe to the correct folder then you should be able to use it to execute migrations against the database.</span></span> <span data-ttu-id="3ec3f-118">Tutte le utilità sono progettate per eseguire le migrazioni.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-118">All the utility is designed to do is execute migrations.</span></span> <span data-ttu-id="3ec3f-119">Non è possibile generare migrazioni o creare uno script SQL.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-119">It cannot generate migrations or create a SQL script.</span></span>

## <a name="see-options"></a><span data-ttu-id="3ec3f-120">Vedere le opzioni</span><span class="sxs-lookup"><span data-stu-id="3ec3f-120">See options</span></span>

``` console
Migrate.exe /?
```

<span data-ttu-id="3ec3f-121">Sopra verrà visualizzata la pagina della Guida associata a questa utilità. si noti che è necessario che EntityFramework. dll sia nello stesso percorso in cui si esegue migrate. exe per poter funzionare.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-121">The above will display the help page associated with this utility, note that you will need to have the EntityFramework.dll in the same location that you are running migrate.exe in order for this to work.</span></span>

## <a name="migrate-to-the-latest-migration"></a><span data-ttu-id="3ec3f-122">Eseguire la migrazione alla migrazione più recente</span><span class="sxs-lookup"><span data-stu-id="3ec3f-122">Migrate to the latest migration</span></span>

``` console
Migrate.exe MyMvcApplication.dll /startupConfigurationFile="..\\web.config"
```

<span data-ttu-id="3ec3f-123">Quando si esegue migrate. exe, l'unico parametro obbligatorio è l'assembly, ovvero l'assembly contenente le migrazioni che si sta tentando di eseguire, ma verranno utilizzate tutte le impostazioni basate sulla convenzione se non si specifica il file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-123">When running migrate.exe the only mandatory parameter is the assembly, which is the assembly that contains the migrations that you are trying to run, but it will use all convention based settings if you do not specify the configuration file.</span></span>

## <a name="migrate-to-a-specific-migration"></a><span data-ttu-id="3ec3f-124">Eseguire la migrazione a una migrazione specifica</span><span class="sxs-lookup"><span data-stu-id="3ec3f-124">Migrate to a specific migration</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile="MyApp.exe.config" /targetMigration="AddTitle"
```

<span data-ttu-id="3ec3f-125">Se si desidera eseguire le migrazioni fino a una migrazione specifica, è possibile specificare il nome della migrazione.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-125">If you want to run migrations up to a specific migration, then you can specify the name of the migration.</span></span> <span data-ttu-id="3ec3f-126">Questa operazione consente di eseguire tutte le migrazioni precedenti, se necessario, fino alla migrazione specificata.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-126">This will run all previous migrations as required until getting to the migration specified.</span></span>

## <a name="specify-working-directory"></a><span data-ttu-id="3ec3f-127">Specifica directory di lavoro</span><span class="sxs-lookup"><span data-stu-id="3ec3f-127">Specify working directory</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile="MyApp.exe.config" /startupDirectory="c:\\MyApp"
```

<span data-ttu-id="3ec3f-128">Se l'assembly ha dipendenze o legge i file relativi alla directory di lavoro, sarà necessario impostare startupDirectory.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-128">If you assembly has dependencies or reads files relative to the working directory then you will need to set startupDirectory.</span></span>

## <a name="specify-migration-configuration-to-use"></a><span data-ttu-id="3ec3f-129">Specificare la configurazione della migrazione da usare</span><span class="sxs-lookup"><span data-stu-id="3ec3f-129">Specify migration configuration to use</span></span>

``` console
Migrate.exe MyAssembly CustomConfig /startupConfigurationFile="..\\web.config"
```

<span data-ttu-id="3ec3f-130">Se sono presenti più classi di configurazione della migrazione, le classi che ereditano da DbMigrationConfiguration, è necessario specificare che deve essere usato per questa esecuzione.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-130">If you have multiple migration configuration classes, classes inheriting from DbMigrationConfiguration, then you need to specify which is to be used for this execution.</span></span> <span data-ttu-id="3ec3f-131">Questa impostazione viene specificata fornendo il secondo parametro facoltativo senza un'opzione come sopra.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-131">This is specified by providing the optional second parameter without a switch as above.</span></span>

## <a name="provide-connection-string"></a><span data-ttu-id="3ec3f-132">Specificare la stringa di connessione</span><span class="sxs-lookup"><span data-stu-id="3ec3f-132">Provide connection string</span></span>

``` console
Migrate.exe BlogDemo.dll /connectionString="Data Source=localhost;Initial Catalog=BlogDemo;Integrated Security=SSPI" /connectionProviderName="System.Data.SqlClient"
```

<span data-ttu-id="3ec3f-133">Se si desidera specificare una stringa di connessione dalla riga di comando, è necessario fornire anche il nome del provider.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-133">If you wish to specify a connection string at the command line then you must also provide the provider name.</span></span> <span data-ttu-id="3ec3f-134">Se non si specifica il nome del provider, verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-134">Not specifying the provider name will cause an exception.</span></span>

## <a name="common-problems"></a><span data-ttu-id="3ec3f-135">Problemi comuni</span><span class="sxs-lookup"><span data-stu-id="3ec3f-135">Common Problems</span></span>

| <span data-ttu-id="3ec3f-136">Messaggio di errore</span><span class="sxs-lookup"><span data-stu-id="3ec3f-136">Error Message</span></span>                                                                                                                                                                                                                                                                                                                      | <span data-ttu-id="3ec3f-137">Soluzione</span><span class="sxs-lookup"><span data-stu-id="3ec3f-137">Solution</span></span>                                                                                                                                                                                                                                                                                             |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="3ec3f-138">Eccezione non gestita: System. IO. FileLoadException: Impossibile caricare il file o l'assembly ' EntityFramework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089' o una delle relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-138">Unhandled Exception: System.IO.FileLoadException:  Could not load file or assembly 'EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="3ec3f-139">La definizione del manifesto dell'assembly individuato non corrisponde al riferimento all'assembly.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-139">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="3ec3f-140">(Eccezione da HRESULT: 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="3ec3f-140">(Exception from HRESULT: 0x80131040)</span></span>         | <span data-ttu-id="3ec3f-141">Ciò significa in genere che si esegue un'applicazione .NET 4 senza il file Redirect. config.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-141">This typically means that you are running a .NET 4 application without the Redirect.config file.</span></span> <span data-ttu-id="3ec3f-142">È necessario copiare il file Redirect. config nello stesso percorso di migrate. exe e rinominarlo in migrate. exe. config.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-142">You need to copy the Redirect.config to the same location as migrate.exe and rename it to migrate.exe.config.</span></span>                                                                                       |
| <span data-ttu-id="3ec3f-143">Eccezione non gestita: System. IO. FileLoadException: Impossibile caricare il file o l'assembly ' EntityFramework, Version = 4.4.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089' o una delle relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-143">Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="3ec3f-144">La definizione del manifesto dell'assembly individuato non corrisponde al riferimento all'assembly.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-144">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="3ec3f-145">(Eccezione da HRESULT: 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="3ec3f-145">(Exception from HRESULT: 0x80131040)</span></span>          | <span data-ttu-id="3ec3f-146">Questa eccezione indica che è in esecuzione un'applicazione .NET 4,5 con reindirizzamento. config copiato nel percorso migrate. exe.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-146">This exception means that you are running a .NET 4.5 application with the Redirect.config copied to the migrate.exe location.</span></span> <span data-ttu-id="3ec3f-147">Se l'app è .NET 4,5, non è necessario avere il file di configurazione con i reindirizzamenti all'interno di.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-147">If your app is .NET 4.5 then you do not need to have the config file with the redirects inside.</span></span> <span data-ttu-id="3ec3f-148">Eliminare il file migrate. exe. config.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-148">Delete the migrate.exe.config file.</span></span>                                    |
| <span data-ttu-id="3ec3f-149">ERRORE: non è possibile aggiornare il database in modo che corrisponda al modello corrente perché sono presenti modifiche in sospeso e la migrazione automatica è disabilitata.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-149">ERROR: Unable to update database to match the current model because there are pending changes and automatic migration is disabled.</span></span> <span data-ttu-id="3ec3f-150">Scrivere le modifiche al modello in sospeso in una migrazione basata su codice o abilitare la migrazione automatica.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-150">Either write the pending model changes to a code-based migration or enable automatic migration.</span></span> <span data-ttu-id="3ec3f-151">Impostare DbMigrationsConfiguration. AutomaticMigrationsEnabled su true per abilitare la migrazione automatica.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-151">Set DbMigrationsConfiguration.AutomaticMigrationsEnabled to true to enable automatic migration.</span></span> | <span data-ttu-id="3ec3f-152">Questo errore si verifica se si esegue la migrazione quando non è stata creata una migrazione per gestire le modifiche apportate al modello e il database non corrisponde al modello.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-152">This error occurs if running migrate when you haven’t created a migration to cope with changes made to the model, and the database does not match the model.</span></span> <span data-ttu-id="3ec3f-153">L'aggiunta di una proprietà a una classe del modello, quindi l'esecuzione di migrate. exe senza creare una migrazione per aggiornare il database è un esempio.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-153">Adding a property to a model class then running migrate.exe without creating a migration to upgrade the database is an example of this.</span></span> |
| <span data-ttu-id="3ec3f-154">ERRORE: il tipo non è stato risolto per il membro ' System. Data. Entity. Migrations. Design. ToolingFacade + UpdateRunner, EntityFramework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089'.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-154">ERROR: Type is not resolved for member 'System.Data.Entity.Migrations.Design.ToolingFacade+UpdateRunner,EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.</span></span>                                                                                                                                       | <span data-ttu-id="3ec3f-155">Questo errore può essere causato dalla specifica di una directory di avvio non corretta.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-155">This error can be caused by specifying an incorrect startup directory.</span></span> <span data-ttu-id="3ec3f-156">Deve corrispondere al percorso di migrate. exe</span><span class="sxs-lookup"><span data-stu-id="3ec3f-156">This must be the location of migrate.exe</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="3ec3f-157">Eccezione non gestita: System. NullReferenceException: riferimento all'oggetto non impostato su un'istanza di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-157">Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object.</span></span> <br/>   <span data-ttu-id="3ec3f-158">in System. Data. Entity. Migrations. Console. Program. Main (String [] args)</span><span class="sxs-lookup"><span data-stu-id="3ec3f-158">at System.Data.Entity.Migrations.Console.Program.Main(String[] args)</span></span>                                                                                                                                             | <span data-ttu-id="3ec3f-159">Questo problema può essere causato dalla mancata specificazione di un parametro obbligatorio per uno scenario in uso.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-159">This can be caused by not specifying a required parameter for a scenario that you are using.</span></span> <span data-ttu-id="3ec3f-160">Ad esempio specificando una stringa di connessione senza specificare il nome del provider.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-160">For example specifying a connection string without specifying the provider name.</span></span>                                                                                                                        |
| <span data-ttu-id="3ec3f-161">ERRORE: nell'assembly ' ClassLibrary1' è stato trovato più di un tipo di configurazione delle migrazioni.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-161">ERROR: More than one migrations configuration type was found in the assembly 'ClassLibrary1'.</span></span> <span data-ttu-id="3ec3f-162">Specificare il nome di quello da usare.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-162">Specify the name of the one to use.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="3ec3f-163">Come indica l'errore, nell'assembly specificato sono presenti più classi di configurazione.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-163">As the error states, there is more than one configuration class in the given assembly.</span></span> <span data-ttu-id="3ec3f-164">È necessario usare l'opzione/configurationType per specificare quale usare.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-164">You must use the /configurationType switch to specify which to use.</span></span>                                                                                                                                           |
| <span data-ttu-id="3ec3f-165">ERRORE: Impossibile caricare il file o l'assembly '&lt;assemblyName&gt;' o una delle relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-165">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;’ or one of its dependencies.</span></span> <span data-ttu-id="3ec3f-166">Il nome o la codebase dell'assembly specificato non è valido.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-166">The given assembly name or codebase was invalid.</span></span> <span data-ttu-id="3ec3f-167">(Eccezione da HRESULT: 0x80131047)</span><span class="sxs-lookup"><span data-stu-id="3ec3f-167">(Exception from HRESULT: 0x80131047)</span></span>                                                                                                                                                    | <span data-ttu-id="3ec3f-168">Questa situazione può essere causata dalla specifica di un nome di assembly in modo errato o senza</span><span class="sxs-lookup"><span data-stu-id="3ec3f-168">This can be caused by specifying an assembly name incorrectly or not having</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="3ec3f-169">ERRORE: Impossibile caricare il file o l'assembly '&lt;assemblyName&gt;' o una delle relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-169">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;' or one of its dependencies.</span></span> <span data-ttu-id="3ec3f-170">Tentativo di caricare un programma con un formato non corretto.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-170">An attempt was made to load a program with an incorrect format.</span></span>                                                                                                                                                                          | <span data-ttu-id="3ec3f-171">Questo errore si verifica se si tenta di eseguire migrate. exe su un'applicazione x64.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-171">This happens if you are trying to run migrate.exe against an x64 application.</span></span> <span data-ttu-id="3ec3f-172">EF 5,0 e versioni precedenti funzioneranno solo su x86.</span><span class="sxs-lookup"><span data-stu-id="3ec3f-172">EF 5.0 and below will only work on x86.</span></span>                                                                                                                                                                                |
